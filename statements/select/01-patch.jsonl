{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Write a query to get all persons email"}, {"role": "assistant", "content": "SELECT email FROM person;"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Give me all people from person table"}, {"role": "assistant", "content": "SELECT email FROM person;"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Give me 5 name and email from person"}, {"role": "assistant", "content": "SELECT name, email FROM person LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Give me 4 name and email from person where contry England"}, {"role": "assistant", "content": "SELECT name, email FROM person WHERE address.country = 'England' LIMIT 4;"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Provide 4 ratings, including the person's name and product name from reviews"}, {"role": "assistant", "content": "SELECT rating, person.name, product.name AS product_name FROM review LIMIT 4;"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Retrieve all orders with status 'pending'"}, {"role": "assistant", "content": "SELECT * FROM order WHERE order_status = 'pending';"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Fetch all products in the 'Women' category with price below 100 USD"}, {"role": "assistant", "content": "SELECT name, price FROM product WHERE category = 'Women' AND price < 100;"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Retrieve all reviews containing the keyword 'impressed'"}, {"role": "assistant", "content": "SELECT * FROM review WHERE review_text CONTAINS 'impressed';"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Retrieve all sellers with their website URLs"}, {"role": "assistant", "content": "SELECT name, website.main, website.docs, website.store FROM seller;"}]}
{"messages": [{"role": "system", "content": "You are a helpful AI assistant that generates SurrealQL queries based on the following schema:\n\nDEFINE FUNCTION fn::number_of_unfulfilled_orders() { RETURN (SELECT count() FROM order WHERE order_status NOTINSIDE ['processed', 'shipped'] GROUP ALL); } PERMISSIONS FULL;\nDEFINE FUNCTION fn::pound_to_usd($price: number) { RETURN $price * 1.26f; } PERMISSIONS FULL;\n\n-- ------------------------------\n-- INDEXES\n-- ------------------------------\n\nDEFINE INDEX unique_wishlist_relationships \n    ON TABLE wishlist \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_cart_relationships \n    ON TABLE cart \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_order_relationships \n    ON TABLE order \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_review_relationships \n    ON TABLE review \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX unique_product_sku_relationships \n    ON TABLE product_sku \n    COLUMNS in, out UNIQUE;\n\nDEFINE INDEX person_country \n    ON TABLE person \n    COLUMNS address.country;\n\nDEFINE INDEX order_count \n    ON TABLE order \n    COLUMNS order_status, created_at;\n\nDEFINE INDEX order_product\n    ON TABLE order\n    COLUMNS product_name;\n\nDEFINE ANALYZER blank_snowball\n    TOKENIZERS blank \n    FILTERS lowercase, snowball(english);\n\nDEFINE INDEX review_content \n    ON TABLE review \n    COLUMNS review_text \n    SEARCH ANALYZER blank_snowball BM25 HIGHLIGHTS;\n\nDEFINE INDEX idx_product_details_embedding ON product \n    FIELDS details_embedding \n    MTREE DIMENSION 768 DIST COSINE;\n\n-- ------------------------------\n-- TABLE: avg_product_review\n-- ------------------------------\n\nDEFINE TABLE avg_product_review TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_reviews, math::mean(<float> rating) AS avg_review, ->product.id AS product_id, ->product.name AS product_name FROM review GROUP BY product_id, product_name;\nDEFINE FIELD avg_review \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD id \n    ON TABLE avg_product_review \n    TYPE record<avg_product_review>;\nDEFINE FIELD number_of_reviews \n    ON TABLE avg_product_review \n    TYPE number;\nDEFINE FIELD product_id \n    ON TABLE avg_product_review \n    TYPE array<record<product>>;\nDEFINE FIELD product_name \n    ON TABLE avg_product_review \n    TYPE array<string>;\n\n-- ------------------------------\n-- TABLE: monthly_sales\n-- ------------------------------\n\nDEFINE TABLE monthly_sales TYPE NORMAL SCHEMAFULL AS SELECT count() AS number_of_orders, time::format(time.created_at, '%Y-%m') AS month, math::sum(price * quantity) AS sum_sales, currency FROM order GROUP BY month, currency;\nDEFINE FIELD id \n    ON TABLE monthly_sales \n    TYPE record<monthly_sales>;\nDEFINE FIELD currency \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD month \n    ON TABLE monthly_sales \n    TYPE string;\nDEFINE FIELD number_of_orders \n    ON TABLE monthly_sales \n    TYPE number;\nDEFINE FIELD sum_sales \n    ON TABLE monthly_sales \n    TYPE number;\n-- ------------------------------\n-- TABLE: address_history\n-- ------------------------------\n\nDEFINE TABLE address_history TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE address_history \n    TYPE record<address_history>;\nDEFINE FIELD person \n    ON TABLE address_history \n    TYPE record<person>;\nDEFINE FIELD addresses \n    ON TABLE address_history \n    TYPE array<object>;\nDEFINE FIELD addresses.*.address_line_1 \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.address_line_2 \n    ON TABLE address_history \n    TYPE option<string>;\nDEFINE FIELD addresses.*.city \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.coordinates \n    ON TABLE address_history \n    TYPE geometry<point>;\nDEFINE FIELD addresses.*.country \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD addresses.*.post_code \n    ON TABLE address_history \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE address_history \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE address_history \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE address_history \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: payment_details\n-- ------------------------------\n\nDEFINE TABLE payment_details TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE payment_details \n    TYPE record<payment_details>;\nDEFINE FIELD person \n    ON TABLE payment_details \n    TYPE record<person>;\nDEFINE FIELD stored_cards \n    ON TABLE payment_details \n    FLEXIBLE TYPE array<object>;\nDEFINE FIELD time \n    ON TABLE payment_details \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE payment_details \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE payment_details \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: person\n-- ------------------------------\n\nDEFINE TABLE person TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE person \n    TYPE record<person>;\nDEFINE FIELD first_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD last_name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD name \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD company_name \n    ON TABLE person \n    TYPE option<string>;\nDEFINE FIELD email \n    ON TABLE person \n    TYPE string \n    ASSERT string::is::email($value);\nDEFINE FIELD phone \n    ON TABLE person \n    TYPE string;\nDEFINE FIELD address \n    ON TABLE person \n    FLEXIBLE TYPE object;\nDEFINE FIELD address_history \n    ON TABLE person \n    TYPE record<address_history>;\nDEFINE FIELD payment_details \n    ON TABLE person \n    TYPE record<payment_details>;\nDEFINE FIELD time \n    ON TABLE person \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE person \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE person \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product\n-- ------------------------------\n\nDEFINE TABLE product TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product \n    TYPE record<product>;\nDEFINE FIELD name \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD details \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD details_embedding\n    ON TABLE product \n    TYPE array<decimal>;\nDEFINE FIELD category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD sub_category \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD colours \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD sizes \n    ON TABLE product \n    TYPE array<string>;\nDEFINE FIELD price \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD currency \n    ON TABLE product \n    TYPE string;\nDEFINE FIELD images \n    ON TABLE product \n    TYPE array<object>;\nDEFINE FIELD images.*.url \n    ON TABLE product \n    TYPE string\n    ASSERT string::is::url($value);\nDEFINE FIELD images.*.position \n    ON TABLE product \n    TYPE number;\nDEFINE FIELD seller \n    ON TABLE product \n    TYPE record<seller>;\nDEFINE FIELD time \n    ON TABLE product \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: product_sku\n-- ------------------------------\n\nDEFINE TABLE product_sku TYPE RELATION FROM product TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE product_sku \n    TYPE record<product_sku>;\nDEFINE FIELD quantity \n    ON TABLE product_sku \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD size \n    ON TABLE product_sku \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE product_sku \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE product_sku \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE product_sku \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: wishlist\n-- ------------------------------\n\nDEFINE TABLE wishlist TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE wishlist \n    TYPE record<wishlist>;\nDEFINE FIELD time \n    ON TABLE wishlist \n    TYPE object;\nDEFINE FIELD colour \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE wishlist\n    TYPE string;\nDEFINE FIELD time.created_at \n    ON TABLE wishlist \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.deleted_at \n    ON TABLE wishlist \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: cart\n-- ------------------------------\n\nDEFINE TABLE cart TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE cart \n    TYPE record<cart>;\nDEFINE FIELD in \n    ON TABLE cart \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE cart \n    TYPE record<product>;\nDEFINE FIELD product_name \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE cart \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE cart \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE cart\n    TYPE string;\nDEFINE FIELD time \n    ON TABLE cart \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE cart \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE cart \n    TYPE datetime\n    VALUE time::now();\n\n\n-- ------------------------------\n-- TABLE: order\n-- ------------------------------\n\nDEFINE TABLE order TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD product_name \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD currency \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD price \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD quantity \n    ON TABLE order \n    TYPE number;\nDEFINE FIELD colour \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD size \n    ON TABLE order\n    TYPE string;\nDEFINE FIELD shipping_address \n    ON TABLE order \n    FLEXIBLE TYPE object;\nDEFINE FIELD payment_method \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD order_status \n    ON TABLE order \n    TYPE string;\nDEFINE FIELD id \n    ON TABLE order \n    TYPE record<order>;\nDEFINE FIELD in \n    ON TABLE order \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE order \n    TYPE record<product>;\nDEFINE FIELD time \n    ON TABLE order \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE order \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE order \n    TYPE datetime\n    VALUE time::now();\nDEFINE FIELD time.processed_at \n    ON TABLE order \n    TYPE option<datetime>;\nDEFINE FIELD time.shipped_at \n    ON TABLE order \n    TYPE option<datetime>;\n\n-- ------------------------------\n-- TABLE: review\n-- ------------------------------\n\nDEFINE TABLE review TYPE RELATION FROM person TO product SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE review \n    TYPE record<review>;\nDEFINE FIELD in \n    ON TABLE review \n    TYPE record<person>;\nDEFINE FIELD out \n    ON TABLE review \n    TYPE record<product>;\nDEFINE FIELD rating \n    ON TABLE review \n    TYPE number \n    ASSERT $value > 0 AND $value < 6;\nDEFINE FIELD review_text \n    ON TABLE review \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE review \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE review \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE review \n    TYPE datetime\n    VALUE time::now();\n\n-- ------------------------------\n-- TABLE: seller\n-- ------------------------------\n\nDEFINE TABLE seller TYPE NORMAL SCHEMAFULL PERMISSIONS none;\nDEFINE FIELD id \n    ON TABLE seller \n    TYPE record<seller>;\nDEFINE FIELD name \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD addresses \n    ON TABLE seller \n    FLEXIBLE TYPE object;\nDEFINE FIELD website \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD website.main \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.docs \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD website.store \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD email \n    ON TABLE seller \n    TYPE string;\nDEFINE FIELD time \n    ON TABLE seller \n    TYPE object;\nDEFINE FIELD time.created_at \n    ON TABLE seller \n    TYPE datetime\n    DEFAULT time::now();\nDEFINE FIELD time.updated_at \n    ON TABLE seller \n    TYPE datetime\n    VALUE time::now();"}, {"role": "user", "content": "Write a query to get all products in the 'Men' category"}, {"role": "assistant", "content": "SELECT * FROM product WHERE category = 'Men';"}]}
