{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Give me the person with product name 'T-Shirt' is in wishlist"},{"role":"assistant","content":"SELECT * FROM person WHERE ->wishlist->(product WHERE name = 'T-Shirt');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Select a person who has wishlist a product with name 'Mens Surreal T-Shirt'"},{"role":"assistant","content":"SELECT * FROM person WHERE ->wishlist->(product WHERE name = 'Mens Surreal T-Shirt');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Give me 4 emails from person and what they ordered"},{"role":"assistant","content":"SELECT email, ->order->product AS orders FROM person LIMIT 4;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Give me 4 emails from person with order_status 'pending'"},{"role":"assistant","content":"SELECT email AS orders_email FROM person WHERE ->(order WHERE order_status = 'pending') LIMIT 4;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show 5 users who have products in their cart"},{"role":"assistant","content":"SELECT * FROM person WHERE ->cart->product LIMIT 5;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all people who live in 'New York' and have at least one item in their cart"},{"role":"assistant","content":"SELECT * FROM person WHERE address.city = 'New York' AND ->cart->product;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List the names and emails of users who have placed an order with order_status 'shipped'"},{"role":"assistant","content":"SELECT name, email FROM person WHERE ->(order WHERE order_status = 'shipped');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show me the products that 'John Doe' has in his wishlist"},{"role":"assistant","content":"SELECT ->wishlist->product FROM person WHERE name = 'John Doe';"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve the top 5 products that have been ordered by users from address country 'Wales'"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-(person WHERE address.country = 'Wales') LIMIT 5;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the emails of users who have not placed any orders"},{"role":"assistant","content":"SELECT email FROM person WHERE !->order;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all products that are in the carts of users aged over 30"},{"role":"assistant","content":"SELECT * FROM product WHERE <-cart<-person WHERE age > 30;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List the names of users who have purchased both 'Laptop' and 'Mouse'"},{"role":"assistant","content":"SELECT name FROM person WHERE ->order->(product WHERE name = 'Laptop') AND ->order->(product WHERE name = 'Mouse');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have reviewed a product with rating higher than 4"},{"role":"assistant","content":"SELECT * FROM person WHERE ->(review WHERE rating > 4);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show the users who have both items in their cart and wishlist"},{"role":"assistant","content":"SELECT * FROM person WHERE ->cart->product AND ->wishlist->product;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Based on all the products this person 01FTP9H7BG8VDANQPN8J3Y857R ordered, which persons also ordered those products and what did they order"},{"role":"assistant","content":"SELECT ->order->product<-order<-person->order->product FROM person:01FTP9H7BG8VDANQPN8J3Y857R"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Which products did this person 01FTP9H7BG8VDANQPN8J3Y857R order"},{"role":"assistant","content":"SELECT ->order->product FROM person:01FTP9H7BG8VDANQPN8J3Y857R"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Write a query that retrieves the total value of purchases for a specific customer named Edward Chandler"},{"role":"assistant","content":"SELECT id,->order.out AS bought, math::sum(->order.*.price) AS total FROM person WHERE name='Edward Chandler' FETCH bought;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Give me the total price of order for a person named Edward Chandler"},{"role":"assistant","content":"SELECT id,->order.out AS bought, math::sum(->order.*.price) AS total FROM person WHERE name='Edward Chandler' FETCH bought;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the product which contains medium fit in details"},{"role":"assistant","content":"SELECT id FROM product WHERE details.map(|$detail| string::lowercase($detail)) CONTAINS 'medium fit' FETCH id;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the product which contains men in category"},{"role":"assistant","content":"SELECT id FROM product WHERE string::lowercase(category) CONTAINS 'men' FETCH id;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Select name from ordered products from person with ID 01GQZQRMT08DD99K2V9PJKFSZT"},{"role":"assistant","content":"SELECT id,->order->product.name AS products FROM person:01GQZQRMT08DD99K2V9PJKFSZT;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Give me the ordered products from person with ID 01GQZQRMT08DD99K2V9PJKFSZT"},{"role":"assistant","content":"SELECT id,->order->product.name AS products FROM person:01GQZQRMT08DD99K2V9PJKFSZT;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Give me the ordered products from person who bought more than 4"},{"role":"assistant","content":"SELECT ->order->product.name AS products, id FROM person WHERE count(->order->product) > 4;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Give me the products from person who ordered more than 4"},{"role":"assistant","content":"SELECT ->order->product.name AS products, id FROM person WHERE count(->order->product) > 4;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get email addresses of people who bought each product, by product, sort by ascending product name"},{"role":"assistant","content":"SELECT * FROM (SELECT name, <-order<-person.email AS buyer FROM product ORDER BY name ASC FETCH name) WHERE count(buyer) > 0;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show me the top 5 person based on the number of products sold"},{"role":"assistant","content":"SELECT <-person AS person, count() AS products_sold FROM order GROUP BY person ORDER BY products_sold DESC LIMIT 5;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get emails of users who reviewed product 'Gaming Laptop' with rating 5"},{"role":"assistant","content":"SELECT email FROM person WHERE ->(review WHERE rating = 5)->(product WHERE name = 'Gaming Laptop');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all products reviewed by 'Jane Smith'"},{"role":"assistant","content":"SELECT ->(review)->product FROM person WHERE name = 'Jane Smith';"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show products in the 'Books' category with at least 10 reviews"},{"role":"assistant","content":"SELECT * FROM product WHERE category = 'Books' AND count(<-review<-) >= 10;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find the total sales amount per currency"},{"role":"assistant","content":"SELECT currency, math::sum(price * quantity) AS total_sales FROM order GROUP BY currency;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get all products with 'wireless' in their details"},{"role":"assistant","content":"SELECT * FROM product WHERE details.map(|$detail| string::lowercase($detail)) CONTAINS 'wireless';"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve the average rating for each product"},{"role":"assistant","content":"SELECT ->product.name AS product_name, math::mean(rating) AS avg_rating FROM review GROUP BY product_name;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all users who have both 'Smartphone' and 'Smartwatch' in their wishlist"},{"role":"assistant","content":"SELECT * FROM person WHERE ->wishlist->(product WHERE name = 'Smartphone') AND ->wishlist->(product WHERE name = 'Smartwatch');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the top 5 most reviewed products"},{"role":"assistant","content":"SELECT *, count(<-review<-) AS review_count FROM product ORDER BY review_count DESC LIMIT 5;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List products that have been ordered by users from 'United Kingdom'"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-(person WHERE address.country = 'United Kingdom');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show me all orders with 'pending' status that have not been updated in 30 days"},{"role":"assistant","content":"SELECT * FROM order WHERE order_status = 'pending' AND time::now() - time.updated_at > 30d;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find products that do not have any reviews"},{"role":"assistant","content":"SELECT * FROM product WHERE !->review->person;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List email addresses of users who have purchased products in the 'Clothing' category"},{"role":"assistant","content":"SELECT email FROM person WHERE ->order->(product WHERE category = 'Clothing');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have both 'Laptop' in their cart and 'Mouse' in their order history"},{"role":"assistant","content":"SELECT * FROM person WHERE ->cart->(product WHERE name = 'Laptop') AND ->order->(product WHERE name = 'Mouse');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get products that have been added to the wishlist of users aged under 25"},{"role":"assistant","content":"SELECT * FROM product WHERE <-wishlist<-(person WHERE age < 25);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all products that have been ordered by customers who also reviewed 'wireless headphones'"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-person->review->(product WHERE string::lowercase(name) = 'wireless headphones');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show me the names of people who have items in their cart and have also placed orders in the past month"},{"role":"assistant","content":"SELECT name FROM person WHERE ->cart->product AND ->(order WHERE time.created_at >= time::now() - 30d);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve products that are both in the wishlist and the cart of any user"},{"role":"assistant","content":"SELECT * FROM product WHERE <-wishlist AND <-cart;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find products that have been both reviewed and ordered by 'Emily Clark'"},{"role":"assistant","content":"SELECT * FROM product WHERE <-review<-(person WHERE name = 'Emily Clark') AND <-order<-(person WHERE name = 'Emily Clark');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the list of products purchased by users who have reviewed any 'electronics' category product"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-person->review->(product WHERE string::lowercase(category) = 'electronics');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have never added any products to their wishlist"},{"role":"assistant","content":"SELECT * FROM person WHERE !->wishlist;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List products that have been ordered by at least 5 different users"},{"role":"assistant","content":"SELECT * FROM product WHERE count(<-order) >= 5;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have added the same product to both their cart and wishlist"},{"role":"assistant","content":"SELECT * FROM person WHERE ->cart->product.id = ->wishlist->product.id;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get products that have reviews with the word 'excellent' in the review text"},{"role":"assistant","content":"SELECT * FROM product WHERE id IN (SELECT VALUE out FROM review WHERE string::lowercase(review_text) CONTAINS 'excellent');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get products that have reviews with the word 'quality' in the review text"},{"role":"assistant","content":"SELECT * FROM product WHERE <-(review WHERE string::lowercase(review_text) CONTAINS 'quality');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve users who have ordered products from sellers with a rating higher than 4.5"},{"role":"assistant","content":"SELECT * FROM person WHERE ->order->product->seller.rating > 4.5;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all products that are frequently bought together with 'Smartphone'"},{"role":"assistant","content":"SELECT * FROM product WHERE !<-(product WHERE name = 'Smartphone') AND <-order<-person->order->(product WHERE name = 'Smartphone');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List all users who have purchased products in both 'Books' and 'Music' categories"},{"role":"assistant","content":"SELECT * FROM person WHERE ->order->(product WHERE category = 'Books') AND ->order->(product WHERE category = 'Music');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show products that have not been sold in the last 6 months"},{"role":"assistant","content":"SELECT * FROM product WHERE !<-(order WHERE time.created_at >= time::now() - 24w);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the total number of reviews for products in the 'Home Appliances' category"},{"role":"assistant","content":"SELECT count(<-review) AS total_reviews FROM product WHERE category = 'Home Appliances';"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users whose cart contains products that are not in stock"},{"role":"assistant","content":"SELECT * FROM person WHERE ->cart->product->(product_sku WHERE quantity = 0;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve products ordered by users living in 'Paris' with a rating less than 3"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-(person WHERE address.city = 'Paris') AND id IN (SELECT VALUE out FROM review WHERE rating < 3);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List users who have reviewed products they have not purchased"},{"role":"assistant","content":"SELECT * FROM person WHERE ->review->product.id NOT IN (SELECT out FROM order WHERE in = person.id);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List users who have not placed any orders in the last year"},{"role":"assistant","content":"SELECT * FROM person WHERE !->(order WHERE time.created_at >= time::now() - 1y);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the average order value for customers in 'Canada'"},{"role":"assistant","content":"SELECT math::mean([price * quantity]) AS avg_order_value FROM order WHERE in IN (SELECT VALUE id FROM person WHERE address.country = 'Canada');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the average order value for customers in 'Scotland'"},{"role":"assistant","content":"SELECT math::mean([price * quantity]) AS avg_order_value FROM order WHERE <-(person WHERE address.country = 'Scotland');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show products that have been reviewed more than 50 times"},{"role":"assistant","content":"SELECT * FROM product WHERE count(<-review<-) > 50;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve the total quantity of each product sold"},{"role":"assistant","content":"SELECT out AS product_id, math::sum(quantity) AS total_quantity_sold FROM order GROUP BY product_id;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have both reviewed and wishlisted the same product"},{"role":"assistant","content":"SELECT * FROM person WHERE ->wishlist->product.id = ->review->product.id;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get products that have been ordered but never reviewed"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-person AND !<-review<-person;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find the most popular product category by number of orders"},{"role":"assistant","content":"SELECT category, count() AS order_count FROM product WHERE id IN (SELECT VALUE out FROM order) GROUP BY category ORDER BY order_count DESC LIMIT 1;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find the most popular product category by number of orders"},{"role":"assistant","content":"SELECT category, count() AS order_count FROM product WHERE <-order GROUP BY category ORDER BY order_count DESC LIMIT 1;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have made purchases in a currency different from USD"},{"role":"assistant","content":"SELECT * FROM person WHERE ->(order WHERE currency != 'USD');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the top 3 most active reviewers based on the number of reviews"},{"role":"assistant","content":"SELECT in AS person_id, count() AS review_count FROM review GROUP BY person_id ORDER BY review_count DESC LIMIT 3;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find products that have received only 5-star ratings"},{"role":"assistant","content":"SELECT * FROM product WHERE !->(review WHERE rating < 5);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show users who have left reviews containing the word 'poor'"},{"role":"assistant","content":"SELECT * FROM person WHERE ->(review WHERE string::lowercase(review_text) CONTAINS 'poor');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List products that have not been added to any wishlists"},{"role":"assistant","content":"SELECT * FROM product WHERE !<-wishlist<-person;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the average rating for products in the 'Sports' category"},{"role":"assistant","content":"SELECT * FROM math::mean(SELECT VALUE rating FROM review WHERE ->(product WHERE category = 'Sports'));"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all users who have not made any purchases in the last 6 months"},{"role":"assistant","content":"SELECT * FROM person WHERE !->(order WHERE time.created_at >= time::now() - 24w);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List the top 10 products by the number of times they've been added to wishlists"},{"role":"assistant","content":"SELECT *, count(<-wishlist) AS wishlist_count FROM product ORDER BY wishlist_count DESC LIMIT 10;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have reviewed more than 5 products"},{"role":"assistant","content":"SELECT * FROM person WHERE count(->review) > 5;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List the names and emails of customers who have purchased products in the 'Electronics' category"},{"role":"assistant","content":"SELECT name, email FROM person WHERE ->order->(product WHERE category = 'Electronics');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the total number of items in the carts of all users"},{"role":"assistant","content":"SELECT math::sum(count(->cart)) AS total_cart_items FROM person GROUP ALL;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all products that are low in stock (quantity less than 5)"},{"role":"assistant","content":"SELECT * FROM product WHERE id IN (SELECT VALUE in FROM product_sku WHERE quantity < 5);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show all products that have never been added to any carts"},{"role":"assistant","content":"SELECT * FROM product WHERE !<-cart;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve the average price of products in the 'Clothing' category"},{"role":"assistant","content":"SELECT math::mean(price) AS avg_price FROM product WHERE category = 'Clothing' GROUP ALL;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List users who have the same product both in their cart and wishlist"},{"role":"assistant","content":"SELECT * FROM person WHERE ->cart->product.id = ->wishlist->product.id;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find the top 5 users who have spent the most on orders"},{"role":"assistant","content":"SELECT math::sum(vector::multiply(->order.price, ->order.quantity)) AS total_spent FROM person ORDER BY total_spent DESC LIMIT 5;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve products that have been ordered by users from 'Australia'"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-(person WHERE address.country = 'Australia');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List users who have returned products"},{"role":"assistant","content":"SELECT * FROM person WHERE ->(order WHERE order_status = 'returned');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve products that have been ordered but are not in any user's cart"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order AND !<-cart;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the total revenue generated from orders in 'USD' currency"},{"role":"assistant","content":"SELECT math::sum(price * quantity) AS total_revenue FROM order WHERE currency = 'USD' GROUP BY total_revenue;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find products that have been reviewed by users from 'Germany'"},{"role":"assistant","content":"SELECT * FROM product WHERE <-review<-(person WHERE address.country = 'Germany');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List users who have made orders with quantities greater than 5"},{"role":"assistant","content":"SELECT * FROM person WHERE ->(order WHERE quantity > 5);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find all users who have purchased more than 3 different products"},{"role":"assistant","content":"SELECT id FROM person WHERE count(array::distinct(->order->product)) > 3;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List products that have been added to carts by users from 'Canada'"},{"role":"assistant","content":"SELECT * FROM product WHERE <-cart<-person WHERE address.country = 'Canada';"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the names of users who have both reviewed and ordered 'Smartphone'"},{"role":"assistant","content":"SELECT name FROM person WHERE ->order->(product WHERE name = 'Smartphone') AND ->review->(product WHERE name = 'Smartphone');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show me the total revenue generated from products in the 'Books' category"},{"role":"assistant","content":"SELECT math::sum(price * quantity) AS total_revenue FROM order WHERE out IN (SELECT id FROM product WHERE category = 'Books') GROUP BY total_revenue;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get users who have ordered products with a price higher than $500"},{"role":"assistant","content":"SELECT * FROM person WHERE ->order->(product WHERE price > 500);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List products that have been reviewed with a rating less than 2"},{"role":"assistant","content":"SELECT * FROM product WHERE <-review WHERE rating < 2;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have never added any items to their cart"},{"role":"assistant","content":"SELECT * FROM person WHERE !->cart;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show products that have been both ordered and reviewed by the same user"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-person->review->product;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have added 'Laptop' to their wishlist but have not ordered it"},{"role":"assistant","content":"SELECT * FROM person WHERE ->wishlist->(product WHERE name = 'Laptop') AND !->order->(product WHERE name = 'Laptop');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List products that have been purchased by users from both 'USA' and 'Canada'"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-(person WHERE address.country = 'USA') AND <-order<-(person WHERE address.country = 'Canada');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the average rating of products in the 'Electronics' category"},{"role":"assistant","content":"SELECT math::mean(rating) AS avg_rating FROM review WHERE ->(product WHERE category = 'Electronics') GROUP BY avg_rating;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show users who have placed orders in the last week"},{"role":"assistant","content":"SELECT * FROM person WHERE ->(order WHERE time::now() - time.created_at <= 7d);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List users who have products in their cart that are low in stock (quantity < 5)"},{"role":"assistant","content":"SELECT * FROM person WHERE ->cart->product->(product_sku WHERE quantity < 5);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve all products that have never been ordered"},{"role":"assistant","content":"SELECT * FROM product WHERE !<-order;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have placed an order but have not provided a shipping address"},{"role":"assistant","content":"SELECT * FROM person WHERE ->order AND address.shipping IS NONE;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show the total quantity ordered for each product"},{"role":"assistant","content":"SELECT id, math::sum(<-order.quantity) AS total_quantity FROM product;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List products ordered by users who have more than 5 items in their wishlist"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-(person WHERE count(->wishlist) > 5);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the total number of products in each user's cart"},{"role":"assistant","content":"SELECT id, count(->cart) AS cart_items FROM person;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show users who have both 'Tablet' in their wishlist and 'Laptop' in their cart"},{"role":"assistant","content":"SELECT * FROM person WHERE ->wishlist->(product WHERE name = 'Tablet') AND ->cart->(product WHERE name = 'Laptop');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve products that have been ordered within the last month"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order WHERE time::now() - time.created_at <= 30d;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have reviewed products they have not ordered"},{"role":"assistant","content":"SELECT * FROM person WHERE ->review->product.id NOT IN (SELECT VALUE out FROM order);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List users who have placed more than 10 orders"},{"role":"assistant","content":"SELECT * FROM person WHERE count(->order) > 10;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find products that have been both ordered and returned"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order WHERE order_status = 'returned';"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show users who have ordered products from the 'Furniture' category"},{"role":"assistant","content":"SELECT * FROM person WHERE ->order->(product WHERE category = 'Furniture');"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Get the total number of reviews made by each user"},{"role":"assistant","content":"SELECT id, count(->review) AS review_count FROM person;"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve products that have been ordered but not shipped"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order WHERE order_status != 'shipped';"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Show products that have been reviewed using the word 'excellent'"},{"role":"assistant","content":"SELECT * FROM product WHERE EXISTS(<-review WHERE string::contains(string::lowercase(review_text), 'excellent'));"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Find users who have ordered products priced over $1000"},{"role":"assistant","content":"SELECT * FROM person WHERE ->order->(product WHERE price > 1000);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"List products that have been ordered by users with no email address"},{"role":"assistant","content":"SELECT * FROM product WHERE <-order<-(person WHERE email IS NONE);"}]}
{"messages":[{"role":"system","content":"system_message"},{"role":"user","content":"Retrieve users who have ordered more than one of the same product"},{"role":"assistant","content":"SELECT * FROM person WHERE count(->order) > 1;"}]}